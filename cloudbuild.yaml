steps:
  # Step to pull the service account key secret from Secret Manager
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: 'bash'
    args: ['-c', 'gcloud secrets versions access latest --secret="ServiceAccount_data" --project="103212519156" > /workspace/sa_key.json']
  
  # Build step
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/mlops6-410910/testing', '.']
  
  # Push step
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/mlops6-410910/testing']
